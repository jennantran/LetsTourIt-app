(this["webpackJsonpletstourit-app"]=this["webpackJsonpletstourit-app"]||[]).push([[0],{26:function(e,t,a){e.exports=a(59)},31:function(e,t,a){},32:function(e,t,a){},33:function(e,t,a){e.exports=a.p+"static/media/compass.a050b103.jpg"},38:function(e,t,a){},39:function(e,t,a){},40:function(e,t,a){},56:function(e,t,a){},57:function(e,t,a){},58:function(e,t,a){},59:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(13),i=a.n(o),c=(a(31),a(25)),s=a(1),l=a(2),u=a(4),d=a(3),h=a(11),m=(a(32),function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"handleClick",value:function(e){this.props.history.push("/signUp")}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"homePage"},r.a.createElement("section",{className:"homePageSect"},r.a.createElement("div",null,r.a.createElement("img",{className:"compass",src:a(33),alt:"bay-bridge"})),r.a.createElement("div",{className:"header"},r.a.createElement("h1",null,"Let the Exploring Begin"),r.a.createElement("p",null,r.a.createElement("em",null,"Don't know what to do? ")),r.a.createElement("p",null,r.a.createElement("em",null,"Search for things to do and things to eat. ")),r.a.createElement("button",{onClick:function(t){return e.handleClick(t)}},"Sign Up"))))}}]),n}(n.Component)),p=Object(h.e)(m),v=a(9),f=(a(38),"tour-client-auth-token"),g={saveAuthToken:function(e){window.localStorage.setItem(f,e),console.log(window.localStorage)},getAuthToken:function(){return window.localStorage.getItem(f)},clearAuthToken:function(){window.localStorage.removeItem(f)},hasAuthToken:function(){return!!g.getAuthToken()},makeBasicAuthToken:function(e,t){return window.btoa("".concat(e,":").concat(t))}},b=g,E=r.a.createContext({favorites:[],addFavorite:function(){},deleteFavorite:function(){},handlePostAuthenticate:function(){},handleLogoutClick:function(){},clearFavorites:function(){},user_id:""}),k=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).handleLogoutClick=function(){b.clearAuthToken(),console.log(n.state),n.setState({authToken:void 0}),n.context.clearFavorites()},n.state={authToken:void 0},n}return Object(l.a)(a,[{key:"renderLogoutLink",value:function(){return r.a.createElement("li",{className:"loggedIn"},r.a.createElement(v.b,{onClick:this.handleLogoutClick,to:"/login"},"Logout"))}},{key:"renderLoginLink",value:function(){return r.a.createElement("li",{className:"notLogged-in"},r.a.createElement(v.b,{to:"/login"},"Log in"))}},{key:"render",value:function(){return r.a.createElement("section",{className:"nav"},r.a.createElement("h2",null,"JustTourIt."),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(v.b,{to:"/"},"Home")),r.a.createElement("li",null,r.a.createElement(v.b,{to:"/search"},"Search ")),r.a.createElement("li",null,r.a.createElement(v.b,{to:"/favorites"},"Favorites")),b.hasAuthToken()?this.renderLogoutLink():this.renderLoginLink()))}}]),a}(n.Component);k.contextType=E;var y=k,w=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement("footer",{className:"Footer"},r.a.createElement("p",null,"\xa9Jennifer Tran, 2020. All Rights Reserved."))}}]),a}(n.Component),j=(a(39),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"Place",id:this.props.id},r.a.createElement("h2",{id:"name"}," ",this.props.name+" "," "),r.a.createElement("p",{id:"rating"},this.props.rating),r.a.createElement("p",{id:"address"},this.props.address," "),r.a.createElement("i",{className:"fas fa-heart",onClick:this.props.onClick}))}}]),a}(n.Component)),O=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).updateLocation=function(){navigator&&navigator.geolocation&&navigator.geolocation.getCurrentPosition((function(e){var t=e.coords;n.setState({currentLocation:{lat:t.latitude,lng:t.longitude}})}))},n.updateSearch=function(e){n.setState({search:e})},n.updateRadius=function(e){n.setState({selectedValue:e})},n.checkboxToggle=function(){n.setState({openNowCheck:!n.state.openNowCheck})},n.favoriteToggle=function(e){var t=e.currentTarget.parentNode,a=e.currentTarget.parentNode.children,r={id:t.id,name:a.name.textContent.trim(),rating:a.rating.textContent,address:a.address.textContent,user_id:n.context.user_id};fetch("".concat("http://localhost:8000/api","/favorites/").concat(r.id),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"bearer ".concat(b.getAuthToken())},body:JSON.stringify({faveObject:r})}).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))})).then((function(e){n.context.addFavorite(e)})).catch((function(e){console.error(e)}))},n.handleSubmit=function(e){e.preventDefault();var t,a=n.state.openNowCheck,r=n.state.selectedValue,o=n.state.currentLocation.lat,i=n.state.currentLocation.lng,c="&radius=".concat(r),s="&location=".concat(o,",").concat(i),l="&key=AIzaSyBoLFRF2RY7_h5pL0k4Yo96Q5XI9ivlAAw",u="https://cors-anywhere.herokuapp.com/https://maps.googleapis.com/maps/api/place/textsearch/json?query=",d=[];n.state.search&&d.push("search=".concat(n.state.search)),c&&d.push("radius=".concat(r)),s&&d.push("location=".concat(o,",").concat(i)),a?d.push("".concat("&opennow")):t=u+c+s+l;var h=d.join("&");return t="".concat(u,"?").concat(h,"?").concat(l),console.log(t),fetch(t).then((function(e){return e.json()})).then((function(e){n.setState({results:e.results})})).catch((function(e){console.log("There was an error")}))},n.state={search:"",results:[],selectedValue:"5",openNowCheck:!1,user_id:"",currentLocation:{lat:"",lng:""}},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;this.updateLocation();var t=this.state.results.map((function(t){return r.a.createElement("ul",null,r.a.createElement("li",{key:t.id},r.a.createElement(j,{id:t.id,name:t.name,address:t.formatted_address,rating:t.rating,onClick:function(t){return e.favoriteToggle(t)}})))}));return r.a.createElement("div",null,r.a.createElement("form",{className:"SearchBox",onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement("input",{required:!0,type:"text",name:"search",id:"search",placeholder:"Search for places...",onChange:function(t){return e.updateSearch(t.target.value)}}),r.a.createElement("input",{type:"submit",className:"submit"}),r.a.createElement("div",{className:"filterOptions"},r.a.createElement("label",{className:"filter"},r.a.createElement("input",{type:"checkbox",value:"openNow",id:"filterByHours",name:"filterByHours",onClick:function(t){return e.checkboxToggle(t.target.value)}}),"Open Now"),r.a.createElement("label",{className:"radius"},"Search by Radius:"),r.a.createElement("select",{value:this.state.selectedValue,onChange:function(t){return e.updateRadius(t.target.value)},name:"radius",id:"radius"},r.a.createElement("option",{value:"1"},"1 miles"),r.a.createElement("option",{value:"5"},"5 miles"),r.a.createElement("option",{value:"10"},"10 miles"),r.a.createElement("option",{value:"20"},"20 miles")))),r.a.createElement("section",{id:"results"},r.a.createElement("h2",null,"Search results"),r.a.createElement("ul",null,t)))}}]),a}(n.Component);O.contextType=E;var C=O,S=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"searchbarControls"},r.a.createElement(C,null))}}]),a}(n.Component),L=a(15),N=(a(40),{position:"absolute",width:"40%",height:"40%"}),T=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(s.a)(this,a);var r=(n=t.call(this,e)).props.initialCenter,o=r.lat,i=r.lng;return n.state={currentLocation:{lat:o,lng:i}},n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(e,t){e.google!==this.props.google&&this.loadMap(),t.currentLocation!==this.state.currentLocation&&this.recenterMap()}},{key:"recenterMap",value:function(){var e=this.map,t=this.state.currentLocation,a=this.props.google.maps;if(e){var n=new a.LatLng(t.lat,t.lng);e.panTo(n)}}},{key:"componentDidMount",value:function(){var e=this;this.props.centerAroundCurrentLocation&&navigator&&navigator.geolocation&&navigator.geolocation.getCurrentPosition((function(t){var a=t.coords;e.setState({currentLocation:{lat:a.latitude,lng:a.longitude}})})),this.loadMap()}},{key:"loadMap",value:function(){if(this.props&&this.props.google){var e=this.props.google.maps,t=this.refs.map,a=i.a.findDOMNode(t),n=this.props.zoom,r=this.state.currentLocation,o=r.lat,c=r.lng,s=new e.LatLng(o,c),l=Object.assign({},{center:s,zoom:n});this.map=new e.Map(a,l)}}},{key:"renderChildren",value:function(){var e=this,t=this.props.children;if(t)return r.a.Children.map(t,(function(t){if(t)return r.a.cloneElement(t,{map:e.map,google:e.props.google,mapCenter:e.state.currentLocation})}))}},{key:"render",value:function(){var e=Object.assign({},N);return r.a.createElement("div",null,r.a.createElement("div",{style:e,ref:"map"},"Loading map..."),this.renderChildren())}}]),a}(r.a.Component),P=T;T.defaultProps={zoom:14,initialCenter:{lat:-1.2884,lng:36.8233},centerAroundCurrentLocation:!1,visible:!0};var A=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={showingInfoWindow:!1,activeMarker:{},selectedPlace:{}},e.onMarkerClick=function(t,a,n){return e.setState({selectedPlace:t,activeMarker:a,showingInfoWindow:!0})},e.onClose=function(t){e.state.showingInfoWindow&&e.setState({showingInfoWindow:!1,activeMarker:null})},e}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement(P,{centerAroundCurrentLocation:!0,google:this.props.google},r.a.createElement(L.Marker,{onClick:this.onMarkerClick,name:"current location"}),r.a.createElement(L.InfoWindow,{marker:this.state.activeMarker,visible:this.state.showingInfoWindow,onClose:this.onClose},r.a.createElement("div",null,r.a.createElement("h4",null,this.state.selectedPlace.name))))}}]),a}(n.Component),x=Object(L.GoogleApiWrapper)((function(e){return{apiKey:"AIzaSyBoLFRF2RY7_h5pL0k4Yo96Q5XI9ivlAAw"}}))(A),F=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"searchPage"},r.a.createElement(S,null),r.a.createElement(x,null))}}]),a}(n.Component);a(56);function U(e){return e.message?r.a.createElement("div",{className:"error"},e.message):r.a.createElement(r.a.Fragment,null)}var I=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).handleSubmit=function(e){e.preventDefault(),n.context.handlePostAuthenticate(n.state),n.props.history.push("/favorites")},n.state={username:{value:"",touched:!1},password:{value:"",touched:!1}},n}return Object(l.a)(a,[{key:"updateUser",value:function(e){this.setState({username:{value:e,touched:!0}})}},{key:"updatePassword",value:function(e){this.setState({password:{value:e,touched:!0}})}},{key:"validateUser",value:function(){var e=this.state.username.value.trim();return 0===e.length?"username is required":e.length<3?"Username must be at least 3 characters long":void 0}},{key:"validatePassword",value:function(){var e=this.state.password.value.trim();return 0===e.length?"Password is required":e.length<6||e.length>72?"Password must be between 6 and 72 characters long":void 0}},{key:"render",value:function(){var e=this,t=this.validateUser(),a=this.validatePassword();return r.a.createElement("div",{className:"loginForm"},r.a.createElement("form",{className:"userForm",onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement("h1",null,"Login"),r.a.createElement("label",null,"Username:",r.a.createElement("input",{type:"text",className:"formInput",name:"user",id:"user",onChange:function(t){return e.updateUser(t.target.value)}}),this.state.username.touched&&r.a.createElement(U,{message:t})),r.a.createElement("label",null,"Password:",r.a.createElement("input",{type:"password",name:"password",className:"formInput",id:"password",onChange:function(t){return e.updatePassword(t.target.value)}}),this.state.password.touched&&r.a.createElement(U,{message:a})),r.a.createElement("input",{type:"submit",value:"submit"})))}}]),a}(n.Component);I.contextType=E;var _=I,M=(a(57),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"favorite",id:this.props.id},r.a.createElement("h2",{id:"name"},this.props.name+" "),r.a.createElement("p",{id:"rating"},this.props.rating),r.a.createElement("p",{id:"address"},this.props.address," "),r.a.createElement("button",{className:"delete",onClick:this.props.onClick},"Delete"))}}]),a}(r.a.Component));M.contextType=E;var R=M,D=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={error:null,favorites:[]},e.handleDelete=function(t){var a=t.currentTarget.parentNode.children,n={id:t.currentTarget.parentNode.id,name:a.name.textContent.trim(),rating:a.rating.textContent,address:a.address.textContent,user_id:e.context.user_id};e.context.deleteFavorite(n)},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.context.favorites;return r.a.createElement("section",{className:"favList"},r.a.createElement("h2",null,"Favorites"),r.a.createElement("ul",{className:"favoritesList"},r.a.createElement("li",{key:t.id},t.map((function(t){return r.a.createElement(R,{id:t.id,name:t.name,rating:t.rating,address:t.address,onClick:function(t){return e.handleDelete(t)}})})))))}}]),a}(n.Component);D.contextType=E,D.defaultProps={favorites:[]};var z=D,B=(a(58),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).handleRegistrationRedirect=function(){n.props.history.push("/login")},n.handleSubmit=function(e){e.preventDefault();var t=n.state,a={username:t.username,password:t.password};n.context.addUser(a),alert("Successful sign up"),n.handleRegistrationRedirect()},n.state={username:{value:"",touched:!1},password:{value:"",touched:!1}},n}return Object(l.a)(a,[{key:"updateUser",value:function(e){this.setState({username:{value:e,touched:!0}})}},{key:"updatePassword",value:function(e){this.setState({password:{value:e,touched:!0}})}},{key:"validateUsername",value:function(){var e=this.state.username.value.trim();return 0===e.length?"username is required":e.length<3?"Username must be at least 3 characters long":void 0}},{key:"validatePassword",value:function(){var e=this.state.password.value.trim();return 0===e.length?"Password is required":e.length<6||e.length>72?"Password must be between 6 and 72 characters long":e.match(/[0-9]/)?void 0:"Password must contain at least one number"}},{key:"render",value:function(){var e=this,t=this.validateUsername(),a=this.validatePassword();return r.a.createElement("div",{className:"signUpForm"},r.a.createElement("form",{className:"userForm",onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement("h1",null,"Sign Up"),r.a.createElement("label",null,"User:",r.a.createElement("input",{type:"text",className:"formInput",name:"user",id:"user",onChange:function(t){return e.updateUser(t.target.value)}}),this.state.username.touched&&r.a.createElement(U,{message:t})),r.a.createElement("label",null,"Password:",r.a.createElement("input",{type:"password",name:"password",className:"formInput",id:"password",onChange:function(t){return e.updatePassword(t.target.value)}}),this.state.password.touched&&r.a.createElement(U,{message:a})),r.a.createElement("input",{type:"submit",value:"submit"})))}}]),a}(n.Component));B.contextType=E;var J=Object(h.e)(B),W={postLogin:function(e){return fetch("".concat("http://localhost:8000/api","/auth/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))}))}},q=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={favorites:[],addFavorite:e.addFavorite,deleteFavorite:e.deleteFavorite,addUser:e.addUser,error:null,user_id:""},e.handlePostAuthenticate=function(t){var a=t.username,n=t.password;t.user_id;W.postLogin({username:a.value,password:n.value}).then((function(t){b.saveAuthToken(t.authToken),e.setState({user_id:t.user_id}),fetch("http://localhost:8000/api/favorites",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"bearer ".concat(b.getAuthToken()),user_id:t.user_id}}).then((function(e){return e.json()})).then((function(t){if(t.success&&!1===t.success)throw new Error("error in getting favorites");console.log(t),e.setState({favorites:t})})).catch((function(e){console.error(e)}))})).catch((function(t){e.setState({error:t.error})}))},e.addFavorite=function(t){e.setState({favorites:[].concat(Object(c.a)(e.state.favorites),[t])}),setTimeout((function(){return console.log(e.state)}))},e.deleteFavorite=function(t){return fetch("".concat("http://localhost:8000/api","/favorites/").concat(t.id),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"bearer ".concat(b.getAuthToken())}}).then((function(a){return console.log(t),e.setState({favorites:e.state.favorites.filter((function(e){return e.id!==t.id}))}),a})).catch((function(t){console.error(t),e.setState({error:t})}))},e.addUser=function(e){return fetch("".concat("http://localhost:8000/api","/signUp"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e})})},e.clearFavorites=function(){e.setState({favorites:[]})},e}return Object(l.a)(a,[{key:"render",value:function(){var e={favorites:this.state.favorites,addFavorite:this.addFavorite,deleteFavorite:this.deleteFavorite,handlePostAuthenticate:this.handlePostAuthenticate,clearFavorites:this.clearFavorites,user_id:this.state.user_id,addUser:this.addUser};return r.a.createElement("div",{className:"app"},r.a.createElement(E.Provider,{value:e},r.a.createElement("nav",null,r.a.createElement(y,null)),r.a.createElement("main",null,r.a.createElement(h.a,{exact:!0,path:"/",component:p}),r.a.createElement(h.a,{path:"/search",component:F}),r.a.createElement(h.a,{path:"/login",component:_}),r.a.createElement(h.a,{path:"/signUp",component:J}),r.a.createElement(h.a,{path:"/favorites",component:z}))),r.a.createElement("footer",null,r.a.createElement(w,null)))}}]),a}(n.Component);i.a.render(r.a.createElement(v.a,null,r.a.createElement(E.Provider,null,r.a.createElement(q,null))),document.getElementById("root"))}},[[26,1,2]]]);
//# sourceMappingURL=main.c12cd31b.chunk.js.map